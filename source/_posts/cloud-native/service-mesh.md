---
title: 服务网格
date: 2022-07-18 02:04:02
tags:
    - ServiceMesh
    - CloudNative
---
# 服务网格

## 什么是服务网格?

服务网格（例如开源项目 [Istio](https://www.redhat.com/zh/topics/microservices/what-is-istio)）用于控制应用的不同部分之间如何共享数据。与用于管理此类通信的其他系统不同，服务网格内置于应用程序中的专用基础架构层。这个可见的基础架构层可以记录应用的不同部分是否能正常交互。因此，随着应用的不断发展，它在优化通信和避免停机方面就显得更加有用。

应用的每个部分——即"服务"，都要与其他服务相互协作，来为用户提供所需的内容。如果在线零售应用的用户想购买什么东西，他们得知道该商品是否有货。因此，负责与公司库存数据库通信的服务需要与产品网页进行通信，而产品网页本身，也需要与用户的在线购物车通信。为了增加业务价值，该零售商之后可能会推出一项新服务：在应用中为用户提供产品推荐。要推荐产品，这项新服务除了要与产品标签数据库进行通信外，还需要与产品页面所需的同一个库存数据库进行通信，因此这涉及到大量可重复使用的移动组件。

现代应用常以这种方式拆分，所有组件构成一个服务网络，每一个都分别执行特定的业务功能。要执行相应的功能，一项服务可能需要向其他几项服务请求数据。但如果有些服务（例如零售商的库存数据库）遇到请求超载会怎样呢？这就要靠服务网格了，它会将请求从一项服务路由到下一项，从而优化所有移动组件的协同工作方式。

## 服务网格的关键因素
- 可靠性
	服务网格通过边车代理，保证容器、服务之间通信的高效和可靠
- 可见性
	服务网格提供服务健康检查和行为监控。控制平面可以收集并统计服务的运行情况，包括服务的网络时延、网络状况、分布式追踪和日志。通常可以用到的工具有Prometheus,Elasticsearch,Grafana等
- 安全
	服务网格可以自动加密服务间通信，执行分布式安全策略

## 服务网格的优点和劣势

### 优点
- 简化服务间通信给传统业务编码带来的不必要管理成本
- 更容易诊断通信错误
- 更容易实现安全，支持加密通信、鉴权和授权
- 更快测试、发布、开发
- 通过边车模式更加高效管理网络通信

### 劣势
- 运行服务网格本身需要增加服务运营成本
- 增加了通信成本，因为每个服务都需要经由一个边车代理
- 服务网格无法处理和其他服务和系统、传输转换等问题
- 增加了管理成本。网络管理本身非常抽象困难且无法避免，团队中必须有人需要将服务网格适配进工作任务以及管理其配置

## 常见服务网格
> [CNCF Service Mesh Survey 2020]https://www.cncf.io/wp-content/uploads/2020/11/CNCF_Survey_Report_2020.pdf
- AWS App Mesh
- Azure Service Fabric Mesh
- Buoyant Conduit
- F5 Nginx Service Mesh
- Google Anthos Service Mesh
- HashiCorp Consul
- Istio
- Kong Mesh
- Kuma
- Linkerd
- Red Hat OpenShift Service Mesh
- Gloo Mesh
- Tetrate
- Tigera Calico Cloud
- Traefik Labs
- VMware Tanzu Service Mesh